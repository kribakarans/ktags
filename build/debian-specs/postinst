#!/bin/bash

set -u

KTAGSDIR=__ktags
SYSSCRIPTS=/tmp/scripts
HOME_DIR=/home/$SUDO_USER

validate_sudo_user() {
	if [ -z "$SUDO_USER" ]; then
		echo "Invalid SUDO_USER !!!"
		exit 1
	fi

	if [ ! -d $HOME_DIR ]; then
		echo "'$HOME_DIR' path not exist !!!"
		exit 1
	fi

	return $?
}

install_ktags_aliases() {
	VIMRC=$HOME_DIR/.vimrc
	BASHRC=$HOME_DIR/.bashrc

	grep "tags=$KTAGSDIR" $VIMRC > /dev/null 2>&1
	if [ $? -ne 0 ]; then
		echo "Installing vim aliases ..."
		echo "set tags=$KTAGSDIR/tags" >> $VIMRC
	fi

	grep "$KTAGSDIR/cscope" $BASHRC > /dev/null 2>&1
	if [ $? -ne 0 ]; then
		echo "Installing bash aliases ..."
		echo "alias cs='cscope -df $KTAGSDIR/cscope\$1.out'" >> $BASHRC
	fi

	return $?
}

#Main:
validate_sudo_user;
install_ktags_aliases;

exit $?

#EOF
